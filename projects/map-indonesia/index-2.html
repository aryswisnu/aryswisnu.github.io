<html>
  <head>
    <style>
      html,
      body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      }
      #map_canvas {
      width: 100%;
      height: 100%;
      margin-top: -65px
      }
      .infowindow * {
      font-size: 90%;
      margin: 0
      }
      #button_container{
        position: relative;
        top: 10px;
        left: 35%;
        z-index: 10;
        background-color: #fff;
        border: 2px solid #fff;
        border-radius: 3px;
        box-shadow: 0 2px 6px rgba(0,0,0,.3);
        cursor: pointer;
        margin-bottom: 22px;
        text-align: center;
      }
      #button_text_container{
       color: rgb(25,25,25);
       font-family: Roboto,Arial,sans-serif;
       font-size: 16px;
       line-height: 38px;
       padding-left: 5px;
       padding-right: 5px;
      }
    </style>

    <!-- <script src="https://cdn.rawgit.com/aryswisnu/aryswisnu.github.io/master/projects/map-indonesia/geoxml3_kmlStr.js"></script> -->
    <script src="https://www.google.com/jsapi"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC9h9icjUbLnV4txic-Zjli2n9zFFrrZbQ"></script>
  </head>
  <body>
    <table style="width:100%; height:100%;">
      <tr style="width:100%; height:100%;">
        <td style="width:100%; height:100%;">
          <button id="button_container" onClick="zoomControlClick()">
            <div id="button_text_container">
              Menampilkan <span id="current_map_text">Provinsi</span> | Klik untuk melihat: <span id="next_map_text">Kabupaten</span>
            </div>
          </button>
          <div id="map_canvas">
          </div>
        </td>
      </tr>
    </table>
    <script>
      // globals
      var map = null;
      var infoWindow = null;
      var geoXml = null;
      var geoXmlDoc = null;
      var myLatLng = null;
      var myOptions = null;
      var mapCenter = null;
      var geocodeTheCountry = true;
      var gpolygons = [];

      // Fusion Table data ID
      var FT_ProvinsiTableID = "19lLpgsKdJRHL2O4fNmJ406ri9JtpIIk8a-AchA";
      var FT_KabupatenTableID = "1QDDRfgqcsi8_fYREIxt8VhHlWNaVIWGKz5644ONP";
      var FT_KecamatanTableID = "1Zvh6bejgz1eI2pwp-S-dyYcoAhmqefHe2yuVMGoc";
      var CountryName = "Indonesia";
      google.load('visualization', '1', {'packages': ['corechart', 'table', 'geomap']});

      var FTresponse = null;

      var lat = 0.7893;
      var lng = 113.9213;
      var zoomMinProvinsi = 5;
      var zoomMinKabupaten = 10;
      var zoomMinKecamatan = 13;
      var CountryName = "Indonesia";
      var maptype = google.maps.MapTypeId.ROADMAP;
      if (!isNaN(lat) && !isNaN(lng)) {
        myLatLng = new google.maps.LatLng(lat, lng);
      }

      function zoomControlText(currentMapText, nextMapText) {
        document.getElementById("current_map_text").innerHTML = currentMapText;
        document.getElementById("next_map_text").innerHTML = nextMapText;
      }

      function zoomControlClick(){
        var buttoncontainer = document.getElementById("button_container");
        var buttontext = document.getElementById("next_map_text").innerHTML;
        if(buttontext == 'Kabupaten'){
          map.setZoom(zoomMinKabupaten);
          map.setCenter({lat: -6.21462, lng: 106.84513})
        }else if (buttontext == 'Kecamatan') {
          map.setZoom(zoomMinKecamatan);
          map.setCenter({lat: -6.21462, lng: 106.84513})
        }else{
          map.setZoom(zoomMinProvinsi)
          map.setCenter({lat: lat, lng: lng})
        }
      }

      function initialize() {
        myOptions = {
          zoom: zoomMinProvinsi,
          center: myLatLng,
          mapTypeId: maptype
        };

        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        var provinsiLayer = {
          query: {
            select: 'kml_4326',
            from: FT_ProvinsiTableID,
            where: "'name_0' = '" + CountryName + "';"
          },
          styles: [{
            polygonOptions: {
              fillColor: "#008000",
              fillOpacity: 0.1,
              strokeColor: "#008000",
              strokeOpacity: 0.8
            }
          }]
        }
        var kabupatenLayer = {
          query: {
            select: 'geometry',
            from: FT_KabupatenTableID
          },
          styles: [{
            polygonOptions: {
              fillColor: "#FFFF00",
              fillOpacity: 0.1,
              strokeColor: "#FFFF00",
              strokeOpacity: 0.8
            }
          }]
        }
        var kecamatanLayer = {
          query: {
            select: 'geometry',
            from: FT_KecamatanTableID
          },
          styles: [{
            polygonOptions: {
              fillColor: "#FF0000",
              fillOpacity: 0.1,
              strokeColor: "#FF0000",
              strokeOpacity: 0.8
            }
          }]
        }
        var layer = new google.maps.FusionTablesLayer(provinsiLayer);
        layer.setMap(map);

        // Create the DIV to hold the control and call the CenterControl()
        // constructor passing in this DIV.

        zoomControlText('Provinsi', 'Kabupaten')
        google.maps.event.addListener(map, 'zoom_changed', function() {
          var zoomLevel = map.getZoom();
          // console.log(zoomLevel);
          if (zoomLevel >= zoomMinKabupaten && zoomLevel < zoomMinKecamatan) {
            // console.log("KABUPATEN");
            layer.setOptions(kabupatenLayer);
            zoomControlText('Kabupaten', 'Kecamatan')
          }else if (zoomLevel >= zoomMinKecamatan) {
            // console.log("KECAMATAN");
            layer.setOptions(kecamatanLayer);
            zoomControlText('Kecamatan', 'Provinsi')
          }else{
            // console.log('PROVINSI');
            layer.setOptions(provinsiLayer);
            zoomControlText('Provinsi', 'Kabupaten')
          }
        })
      }
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </body>
</html>
